# 지도 표시 문제 진단 가이드

지도가 표시되지 않는 경우 다음을 확인하세요.

## 1단계: 브라우저 콘솔 확인

브라우저에서 F12를 눌러 개발자 도구를 열고 Console 탭을 확인하세요.

### 정상적인 경우
다음과 같은 메시지가 표시되어야 합니다:
```
Leaflet 라이브러리 로드 완료
지도 초기화 시작...
지도 컨테이너 확인 완료
Leaflet 지도 객체 생성 완료
마커 레이어 생성 완료
```

### 문제가 있는 경우

#### "Leaflet 라이브러리를 로드할 수 없습니다"
- **원인**: `lib/leaflet/leaflet.js` 파일이 없거나 경로가 잘못됨
- **해결**: Leaflet 라이브러리를 다운로드하여 `frontend/lib/leaflet/` 디렉토리에 설치

#### "지도 컨테이너(#map)를 찾을 수 없습니다"
- **원인**: HTML 구조 문제
- **해결**: `gis.html` 파일이 올바르게 로드되었는지 확인

#### "지도 생성 실패"
- **원인**: Leaflet 라이브러리 버전 문제 또는 JavaScript 오류
- **해결**: 브라우저 콘솔의 전체 오류 메시지 확인

## 2단계: 네트워크 탭 확인

개발자 도구의 Network 탭에서 다음 파일들이 로드되는지 확인:

### 필수 파일
- ✅ `lib/leaflet/leaflet.css` - 200 OK
- ✅ `lib/leaflet/leaflet.js` - 200 OK
- ✅ `js/api.js` - 200 OK

### 실패한 경우
- ❌ 404 Not Found: 파일 경로 확인
- ❌ CORS 오류: 서버 설정 확인

## 3단계: 지도 요소 확인

브라우저 콘솔에서 다음 명령어를 실행:

```javascript
// 지도 객체 확인
console.log('Map:', map);

// 지도 컨테이너 확인
console.log('Map container:', document.getElementById('map'));

// Leaflet 라이브러리 확인
console.log('Leaflet:', typeof L);
```

### 예상 결과
- `Map:` → `Map {_container: div#map, ...}` (지도 객체)
- `Map container:` → `<div id="map">...</div>` (HTML 요소)
- `Leaflet:` → `"object"` (라이브러리 로드됨)

## 4단계: 타일 로드 확인

Network 탭에서 다음 요청을 확인:

### 구글 지도 타일 (내부망에서 접근 가능한 경우)
- `mt0.google.com` 또는 `mt1.google.com` 요청
- 성공: 200 OK
- 실패: CORS 오류 또는 타임아웃

### 로컬 타일
- `lib/leaflet/tiles/{z}/{x}/{y}.png` 요청
- 성공: 200 OK
- 실패: 404 Not Found (정상, 타일이 없는 경우)

## 5단계: CSS 확인

지도가 보이지 않지만 콘솔에 오류가 없는 경우:

1. Elements 탭에서 `#map` 요소 선택
2. 스타일 확인:
   - `width: 100%`
   - `height: 100%` 또는 `height: calc(100vh - 60px)`
   - `background-color: #f8fafb`

## 일반적인 문제 해결

### 문제 1: 지도가 완전히 비어있음
**원인**: Leaflet 라이브러리 미설치
**해결**: `LEAFLET_DOWNLOAD_GUIDE.md` 참고하여 설치

### 문제 2: 지도는 보이지만 배경이 없음
**원인**: 타일이 로드되지 않음 (정상, 내부망 환경)
**해결**: 
- 배경 이미지 추가: `frontend/images/world-map-background.png`
- 또는 그리드 배경이 자동으로 표시됨

### 문제 3: 마커가 표시되지 않음
**원인**: 프로젝트 데이터에 좌표가 없음
**해결**: 
- 브라우저 콘솔에서 `allProjects` 확인
- 프로젝트 데이터에 `latitude`, `longitude` 값이 있는지 확인

### 문제 4: "데이터를 불러올 수 없습니다" 오류
**원인**: 백엔드 API 연결 실패
**해결**:
- 백엔드 서버가 실행 중인지 확인
- Network 탭에서 `/api/gis/projects` 요청 확인
- 인증 토큰이 유효한지 확인

## 빠른 테스트

브라우저 콘솔에서 다음을 실행하여 지도가 작동하는지 테스트:

```javascript
// 지도가 있는지 확인
if (map) {
    console.log('✅ 지도 객체 존재');
    console.log('중심:', map.getCenter());
    console.log('줌:', map.getZoom());
} else {
    console.log('❌ 지도 객체 없음');
}

// 마커 레이어 확인
if (markersLayer) {
    console.log('✅ 마커 레이어 존재');
    console.log('마커 수:', markersLayer.getLayers().length);
} else {
    console.log('❌ 마커 레이어 없음');
}
```

## 추가 도움

문제가 계속되면 다음 정보를 수집하여 관리자에게 문의:

1. 브라우저 콘솔의 전체 오류 메시지
2. Network 탭의 실패한 요청 목록
3. 브라우저 종류 및 버전
4. 운영체제 정보

